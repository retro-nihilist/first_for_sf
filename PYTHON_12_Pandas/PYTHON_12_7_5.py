"""Даны две таблицы: items_df, в которой содержится информация о наличии товаров на складе, и 
purchase_df — с данными о покупках товаров."""

import pandas as pd

items_df = pd.DataFrame({
    'item_id': [417283, 849734, 132223, 573943, 19475, 3294095, 382043, 302948, 100132, 312394], 
    'vendor': ['Samsung', 'LG', 'Apple', 'Apple', 'LG', 'Apple', 'Samsung', 'Samsung', 'LG', 'ZTE'],
    'stock_count': [54, 33, 122, 18, 102, 43, 77, 143, 60, 19]
})

purchase_df = pd.DataFrame({
    'purchase_id': [101, 101, 101, 112, 121, 145, 145, 145, 145, 221],
    'item_id': [417283, 849734, 132223, 573943, 19475, 3294095, 382043, 302948, 103845, 100132], 
    'price': [13900, 5330, 38200, 49990, 9890, 33000, 67500, 34500, 89900, 11400]
})

"""
item_id — идентификатор модели;
vendor — производитель модели;
stock_count — имеющееся на складе количество данных моделей (в штуках);
purchase_id — идентификатор покупки;
price — стоимость модели в покупке."""

"""Сформируйте DataFrame merged, в котором в результате объединения purchase_df и items_df останутся модели,
которые учтены на складе и имели продажи.
Из таблицы merged найдите суммарную выручку, которую можно было бы получить от продажи всех товаров,
которые учтены на складе и имели продажи. Результат занесите в переменную income."""

# Чат GPT
# Объединение таблиц по столбцу 'item_id'
merged = items_df.merge(purchase_df, on='item_id', how='inner')

# Вычисление суммарной выручки
income = (merged['price'] * merged['stock_count']).sum()

print(merged)
print("Суммарная выручка:", income)

# Взято из чатов
# Объединяем таблицы по столбцу 'item_id' с помощью inner join
"""merged = items_df.merge(purchase_df, how='inner', on='item_id')

# Вычисляем суммарную выручку
income = (merged['price'] * merged['stock_count']).sum()

print(merged)
print("Суммарная выручка:", income)"""